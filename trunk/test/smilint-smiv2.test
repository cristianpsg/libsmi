#!/bin/sh

FORMAT=`echo $0 | sed -e 's/^.*smilint-\(.*\).test/\1/'`

rm -rf smilint-${FORMAT}.out
mkdir smilint-${FORMAT}.out

RC=0

for mib in ${TESTMIBS} ; do
    echo "comparing \`smilint -l 9 dumps/$mib.${FORMAT}' output with dumps/$mib.${FORMAT}.lint."
    ../tools/smilint -l 9 dumps/$mib.${FORMAT} > smilint-${FORMAT}.out/$mib.${FORMAT}.lint 2>&1
    WC=`diff --ignore-blank-lines smilint-${FORMAT}.out/$mib.${FORMAT}.lint dumps/$mib.${FORMAT}.lint | wc -l`
    if [ $WC -ne 0 ] ; then
	echo "*** smilint -l 9 dumps/$mib.${FORMAT} output differs from dumps/$mib.${FORMAT}.lint."
	RC=1
    fi
done

exit ${RC}
